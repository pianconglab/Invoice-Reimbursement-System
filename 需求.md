## 一、系统概述

课题组骈聪课题组发票报销系统旨在为科研人员提供一个轻量、易用的发票报销登记与审批平台，用户无需注册或登录即可访问并填写报销申请表单，管理员通过登录后台进行审批、查询及导出操作。

## 二、系统角色与访问

* **匿名用户（科研人员）**

  * 直接访问公共表单页面填写并提交报销申请，无需注册或登录。
  * 提交后可在表单提交成功页面查看申请编号和状态提示。

* **管理员（课题组负责人/财务）**

  * 通过账号密码登录管理后台。
  * 查看、审批和导出所有用户提交的报销申请。

## 三、功能需求

### 3.1 匿名用户端功能

1. **报销申请表单**

   * 填写字段：

     * 购买人（文本）
     * 商品参数及用途说明（多行文本）
     * 物品名称（文本）
     * 商品链接（URL）
     * 使用途径（单选：个人使用 / 课题组公用）
     * 物品类型（单选：实物产品 / 虚拟产品）
     * 数量（整数）
     * 购买时间（日期选择）
     * 发票号码（文本）
     * 发票金额（金额格式）
     * 开票日期（日期选择）
     * 上传附件（支持多文件上传；系统将自动重命名为“发票号码\_序号.扩展名”）
   * 提交后自动生成唯一申请编号，状态默认为“待审批”。
   * 提交成功后页面显示申请编号和当前状态提示；并提供下载附件或页面二维码以便存档。

### 3.2 管理员后台功能

1. **报销申请管理**

   * 登录后进入工作台，列表展示所有申请记录：

     * 申请编号、购买人、物品名称、使用途径、发票金额、提交时间、当前状态。
   * 支持按购买人、物品类型、使用途径、日期区间、状态等条件搜索与筛选。

2. **审批操作**

   * 点击申请记录查看详情及附件预览/下载。
   * 填写审批意见并设置状态：

     * “报销中”/“已报销”/“驳回”。
   * 审批后状态更新，用户在提交成功页面可查看最终结果。

3. **数据导出与报表**

   * 导出当前筛选结果为 Excel，表格包含所有核心字段及审批意见。
   * 支持按月度或季度生成统计报表，包括报销总金额、申请笔数等汇总信息。

## 四、数据模型

\| 实体   | 字段                                                                           | 说明        |
\| ---

所有相对路径默认以项目根目录（workspace 根）为基准。

若使用 VSCode 运行脚本，可在 `settings.json` 中将：

```json
"python.terminal.executeInFileDir": false
```

禁用“在文件所在目录执行”后，终端当前目录即为工作区根，脚本内的相对路径也会以此为基础。

如果在调试配置中，还可在 `.vscode/launch.json` 的配置项里指定：

```json
"cwd": "${workspaceFolder}"
```

确保调试时工作目录为项目根。

CLI 方式直接执行：

```bash
cd /path/to/project/root
python run.py
```

即可保证相对路径均从项目根解析。
